
<dts-select-container #container2="dts-select-container" [(selectedItems)]="dragSelectItems" (select)="onDragSelect($event)" [contextMenu]="spaceMenu">
  <div class="path">
    <div *ngFor="let item of ParentFolder; first as isfirst">
        <span *ngIf="!isfirst" class="space">>></span>
        <a class="path-link" routerLink="{{'/drive' + item.path}}" (mousedown)="$event.stopPropagation()">{{item.name}}</a>
    </div>
</div>
<div class="tableContainer">
  <table>
    <tr>
      <th id="check" width="30px">
        <div class="checkbox-container">
          <input type="checkbox" name="chk_info2" value="HTML" id="selectAllChkbox" (change)="selectAll($event.target.checked)">
          <label for="selectAllChkbox" (mousedown)="$event.stopPropagation()"></label>
        </div>
      </th>
      <th id="path">파일명</th>
      <th>공용 폴더명</th>
      <th>형식</th>
      <th>크기</th>
      <th>수정일</th>
      <th width="60px">공유</th>
    </tr>
    <tbody cdkDropList (cdkDropListDropped)="drop($event)" (cdkDropListSorted)="drag($event)">
      <tr cdkDrag cdkDragData="{{item.value.path}}" [dtsSelectItem]="item.value.path" *ngFor="let item of nowfile.content | keyvalue:keepOriginalOrder; let i = index" [contextMenu]="basicMenu" [contextMenuSubject]="item.value">
        <div *cdkDragPreview class="dragitem">이동 <b>{{item.value.name}}</b></div>
        <td>
          <div class="checkbox-container">
            <input type="checkbox" name="chk_info" value="{{item.value.path}}" id="{{'chkbox'+ item.value.name}}" (change)="onCheckboxChange(item.value, $event)">
            <label (mousedown)="$event.stopPropagation()" for="{{'chkbox'+ item.value.name}}"></label>
          </div>
          <i *ngIf="item.value.isfolder"></i>
        </td>
        <td *ngIf="item.value.isfolder" (dblclick)="!$event.ctrlKey && router.navigate(['/drive' + item.value.path])">
          <i class="icon" [ngClass]="{'folder-filled':item.value.isShared != true, 'folder-shared':item.value.isShared == true}"></i>

          <span cdkDragHandle (click)='ItemClick($event, item.value)'>{{item.value.name}}</span>
        </td>
        
        <td *ngIf="!item.value.isfolder" (dblclick)="!$event.ctrlKey && item.value.Download(hs)">
          <img *ngIf="item.value.extraData['small'] != null" class="smallThumbnails" src="{{item.value.extraData['small']}}"/>
          <span *ngIf="item.value.extraData['small'] == null">
            <i *ngIf="item.value.type == 'PDF'" class="icon pdf size40"></i>
            <i *ngIf="item.value.type == 'Word'" class="icon word size40"></i>
            <i *ngIf="item.value.type == '문서'" class="icon icon-file size40"></i>
            <i *ngIf="item.value.type == '비디오'" class="icon fa-film size40"></i>
            <i *ngIf="item.value.type == '압축 파일'" class="icon zip size40"></i>
            <i *ngIf="item.value.type == '텍스트'" class="icon fa-edit size40"></i>
            <i *ngIf="item.value.type == '이미지'" class="icon image size40"></i>
          </span>

          <span cdkDragHandle (click)='ItemClick($event, item.value)'>{{item.value.name}}</span>
        </td>
        <td>{{item.value.owner_path}}</td>
        <td>{{item.value.type}}</td>
        <td>{{item.value.bytesString}}</td>
        <td>{{item.value.date}}</td>
        <td>
            <i class="icon share share_animation" [ngClass]="{'disable': item.value.public_hash == null}" (click)="share_file(item.value)"></i>
        </td>
      <td></td>
    </tr>
    </tbody>
  </table>
</div>
</dts-select-container>

<context-menu #basicMenu [useBootstrap4]="true" (open)="CheckingItem($event.item)">
    <ng-template contextMenuItem (execute)="$event.item.Download(hs)">
        <i class="icon download size30"></i>
        다운로드
    </ng-template>
    <ng-template contextMenuItem [visible]="isOneSelect">
        <i class="icon ms365 size30"></i>
        브라우저에서 편집
    </ng-template>
    <ng-template contextMenuItem [visible]="isOneSelect" (execute)="share_file(null)">
        <i class="icon link size30"></i>
        공유
    </ng-template>
    <ng-template contextMenuItem (execute)="move_file()">
        <i class="icon folder-move size30"></i>
        이동 / 복사
    </ng-template>
    <ng-template contextMenuItem [visible]="isOneSelect" (execute)="rename_file()">
        <i class="icon pen size30"></i>
        이름 바꾸기
    </ng-template>
    <ng-template contextMenuItem (execute)="delete_file()">
        <i class="icon delete size30"></i>
        삭제
    </ng-template>
    <ng-template contextMenuItem [visible]="isOneSelect">
        <i class="icon info size30"></i>
        상세 정보
    </ng-template>
    <ng-template contextMenuItem [visible]="isOneSelect">
        <i class="icon transfer size30"></i>
        소유권 이전
    </ng-template>
</context-menu>
<context-menu #spaceMenu [useBootstrap4]="true">
  <ng-template contextMenuItem (execute)="create('새 폴더')">
    <i class="icon folder size30"></i>
    새 폴더
  </ng-template>
  <ng-template contextMenuItem (execute)="go_parent_folder()">
    상위 폴더
  </ng-template>
</context-menu>
